---
export const prerender = true;

import Layout from '../../layouts/Layout.astro';

import ArticleList from '../../components/articles/ArticleList';
import GoTop from '../../components/elements/GoTop';

import { getArticles, getNavigationLinks } from '../../lib/contentful';

import { NavigationLayoutEnum } from '../../types/enum';

const navigationLinks = await getNavigationLinks();
const articles = await getArticles();

export async function getStaticPaths() {
  const navigationLinks = await getNavigationLinks();
  return navigationLinks.map(({ slug }) => ({
    params: { slug: slug }
  }));
}

const { slug } = Astro.params;

const articlesByProfile = articles.filter((a) => a.profile.slug === slug);
---

<Layout
  layout={NavigationLayoutEnum.MAIN}
  navigationLinks={navigationLinks}
  title="Annuaire de keycaps franÃ§aises"
>
  <ArticleList
    slot="main"
    articles={articlesByProfile}
    navigationLinks={navigationLinks}
    client:load
  />
  <GoTop slot="goto" client:load />
</Layout>
